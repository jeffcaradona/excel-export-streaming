sequenceDiagram
  autonumber

  actor U as User (Chrome Browser)
  participant FE as Front-End Web Service (BFF)
  participant API as Node.js API Service
  participant DB as MSSQL Stored Procedure
  participant XLSX as ExcelJS Streaming Writer

  U->>FE: User clicks "Export Excel"
  note over U,FE: Browser navigates directly to download endpoint

  FE->>API: GET /export/report (proxy request)
  note over FE,API: Front-end pipes response stream (no buffering)

  API->>DB: Execute stored procedure (streaming rows)
  note over API,DB: Rows are streamed, not loaded fully into memory

  API->>XLSX: Create streaming workbook (write to HTTP response)

  loop For each row returned
    DB-->>API: Row event
    API->>XLSX: Add row + commit immediately
  end

  DB-->>API: Done event (all rows sent)

  API->>XLSX: Finalize workbook + close stream

  API-->>FE: Streaming XLSX response (attachment headers)
  FE-->>U: Pipe stream to browser download

  note over U: Chrome downloads file without JS memory load
